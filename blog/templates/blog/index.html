{% extends 'base.html' %}
{% load static %}

{% block title %}Blog{% endblock%}

{% block head %}
<meta name="description" content="Nick Wong's blog"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.14.0/css/selectize.default.min.css" integrity="sha512-ogCYKYfJlA0Kc9mxdCu9hQAWv2H7RzzevoB1Ou24geX08ek6hTp+/WDLsqoi3LyMFh1vsuGukSnmszdpxi9Mhw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="{% static 'blog/index.css' %}"/>
{% endblock %}

{% block content %}

<div class="columns is-desktop m-1">
    <div class="column is-three-fifths-desktop">
        {% block center %}
        {% if is_search %}
        <h2>{{ posts|length }} search results{% if search_terms %} for "{{ search_terms }}"{% endif %}</h2>
        {% endif %}
        <ul>
            {% for post in posts %}
            <li><a href="{% url 'post' post.slug %}">{{ post.title }}</a></li>
            {% endfor %}
        </ul>
        {% endblock %}
    </div>
    <div class="column search-bar m-1">
        {% block left %}
        <form method="get" action="{% url 'blog' %}">
            <h4>Search the blog</h4>
            <div class="field">
                <label for="keyword-entry" class="label">Keywords</label>
                <div>
                    <input id="keyword-entry" name="keywords" class="input" type="text"/>
                </div>
            </div>
            <div class="field">
                <div class="is-inline-flex">
                    <label for="tag-selector" class="label">Include tags</label>
                    <button type="button" id="select-all" class="help mx-2">All</button>
                    <button type="button" id="select-none" class="help mx-2">None</button>
                </div>
                <div class="control">
                    <select id="tag-selector" name="tags" multiple>
                        {% for tag in all_tags %}
                        <option {% if tag in active_tags %}selected{% endif %} 
                                value="{{ tag }}">{{ tag }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            <div class="field">
                <div class="control">
                    <button class="button is-link is-small" type="submit">Search</button>
                </div>
            </div>
        </form>
        {% endblock %}
    </div>
    <div class="column m-1">
        {% block right %}
        <div class="card">
            <header class="card-header">
                Welcome to the blog!
            </header>
            <div class="card-image">
                <img src="{% static 'TODO.png' %}"/>
            </div>
            <div class="card-content">
                <h4>Here's what you can expect here:</h4>
                <ul>
                    <li>Unpolished, incomplete thoughts: Life is confusing and I’m also a bad writer</li>
                    <li>Reflections on what I’m reading and listening to</li>
                    <li>Maybe other things, idk what I’m doing lol</li>
                </ul>
                <p>Please feel free to engage in the comments! Respectfully!</p>
            </div>
        </div>
        {% endblock %}
    </div>
</div>

{% endblock%}

{% block scripts %}
{{ block.super }}
<script src="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.14.0/js/selectize.min.js" integrity="sha512-VReIIr1tJEzBye8Elk8Dw/B2dAUZFRfxnV2wbpJ0qOvk57xupH+bZRVHVngdV04WVrjaMeR1HfYlMLCiFENoKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
var $select = $("#tag-selector").selectize({
    plugins: ["remove_button"]
});
var selectize = $select[0].selectize;
$("#select-all").click(function(e) {
    {% for tag in all_tags %}
    selectize.addItem('{{ tag }}', true)
    {% endfor %}
});
$("#select-none").click(function(e) {
    selectize.clear(true)
});
</script>
{% endblock %}